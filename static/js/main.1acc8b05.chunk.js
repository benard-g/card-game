(this["webpackJsonp@packages/frontend"]=this["webpackJsonp@packages/frontend"]||[]).push([[0],{103:function(e,n,r){},116:function(e,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ErrorCode=void 0,function(e){e.LOBBY_NOT_FOUND="LOBBY_NOT_FOUND",e.USER_ALREADY_IN_LOBBY="USER_ALREADY_IN_LOBBY"}(n.ErrorCode||(n.ErrorCode={}))},123:function(e,n,r){"use strict";r.r(n);var t=r(4),c=(r(102),r(103),r(2)),a=r.n(c),o=r(83),i=r.n(o),u=r(51),b=r(10);var s="https://benard-card-game-api.herokuapp.com",l="production",d={possibleTypes:{}},j=new b.ApolloClient({uri:"".concat(s,"/api/graphql"),cache:new b.InMemoryCache({possibleTypes:d.possibleTypes}),credentials:"include",connectToDevTools:"development"===l}),O=function(e){var n=e.children;return Object(t.jsx)(b.ApolloProvider,{client:j,children:n})},f=r(22),p=r.n(f),h=r(30),v=r(31);function g(){return x.apply(this,arguments)}function x(){return(x=Object(h.a)(p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(s,"/api/auth/authenticate"),e.abrupt("return",fetch(n,{method:"POST",credentials:"include"}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=Object(c.createContext)(void 0),m=function(e){var n=e.children,r=Object(c.useState)({authenticated:!1,loading:!0,error:void 0}),a=Object(v.a)(r,2),o=a[0],i=a[1],u=Object(c.useCallback)(Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g();case 3:if(e.sent.ok){e.next=7;break}return i({authenticated:!1,loading:!1,error:new Error("Auth failed")}),e.abrupt("return");case 7:i({authenticated:!0,loading:!1,error:void 0}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),i({authenticated:!1,loading:!1,error:e.t0});case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),[]);return Object(c.useEffect)((function(){o.authenticated||o.error||u()}),[o,u]),Object(t.jsx)(y.Provider,{value:{loading:o.loading,error:o.error},children:n})};var w=r(33),L={classic:{colors:{background:"lightblue"},spacings:{abs4:"4px",abs8:"8px",abs12:"12px",abs16:"16px",abs24:"24px",abs32:"32px",abs40:"40px",abs48:"48px"}}},k=Object(c.createContext)(void 0),_=function(e){var n=e.defaultTheme,r=e.children,a=Object(c.useState)(n),o=Object(v.a)(a,2),i=o[0],u=o[1],b=L[i];return Object(t.jsx)(k.Provider,{value:[{name:i,theme:b},u],children:Object(t.jsx)(w.a,{theme:b,children:r})})};var C=r(96),E=r(89),P=r(90),A=r(45),I=Object(c.createContext)(void 0),T=function(e){var n=e.children,r=e.fallbackLanguage,a=e.languages,o=Object(c.useState)({loading:!0,ready:!1,error:void 0}),i=Object(v.a)(o,2),u=i[0],b=i[1],s=Object(c.useCallback)(Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.use(P.a).use(E.a).use(A.e).init({fallbackLng:r,whitelist:a,react:{wait:!0},debug:!1,returnEmptyString:!1,returnObjects:!0});case 3:b({ready:!0,loading:!1,error:void 0}),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),b({ready:!1,loading:!1,error:e.t0});case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),[r,a]);return Object(c.useEffect)((function(){u.ready||u.error||s()}),[u,s]),Object(t.jsx)(I.Provider,{value:{loading:u.loading,error:u.error,languages:a},children:n})};var B=r(36);function N(){var e=function(){var e=Object(c.useContext)(y);if(!e)throw new Error("Missing wrapping ApiAuthProvider");return{loading:e.loading,error:e.error}}(),n=e.loading,r=e.error,t=function(){var e=Object(c.useContext)(I);if(!e)throw new Error("Missing wrapping I18nextProvider");return{loading:e.loading,error:e.error,languages:e.languages}}(),a=t.loading,o=t.error;return{loading:n||a,error:r||o}}var S=r(67),q=r(98),M=r(11),F=r(39),Y=r(124),D=r(69),R=r(47),U=function(){var e=Object(M.g)(),n=Object(R.a)(),r=Object(v.a)(n,2),c=r[0],a=r[1],o=a.loading,i=a.error,u=function(){var n=Object(h.a)(p.a.mark((function n(){return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,c({variables:{input:{userName:"Adam"}}});case 3:e.push("/lobby"),n.next=8;break;case 6:n.prev=6,n.t0=n.catch(0);case 8:case"end":return n.stop()}}),n,null,[[0,6]])})));return function(){return n.apply(this,arguments)}}();return Object(t.jsxs)("div",{children:[Object(t.jsx)("p",{children:"Create Lobby"}),Object(t.jsx)("br",{}),Object(t.jsx)("p",{children:"TODO: choose your avatar"}),Object(t.jsx)("p",{children:"TODO: choose your name"}),Object(t.jsx)("br",{}),Object(t.jsx)("button",{disabled:o,onClick:u,children:"New lobby"}),i?Object(t.jsx)("p",{children:i.message}):null]})},$=function(e){var n=e.lobby;return Object(t.jsxs)("div",{children:[Object(t.jsx)("p",{children:"You already are in a lobby"}),Object(t.jsxs)("p",{children:["Nb members: ",n.members.length]}),Object(t.jsx)(F.b,{to:"/lobby",children:"Go to Lobby"})]})},J=w.b.div.withConfig({displayName:"styles__Wrapper",componentId:"sc-1du0kus-0"})(["flex-grow:1;"]),Q=function(){var e=Object(Y.a)().t,n=Object(R.b)(),r=n.data,c=n.loading,a=n.error;if(c)return Object(t.jsx)(B.a,{});if(a||!r)return Object(t.jsx)(D.a,{error:a});var o=r.viewer.lobby;return Object(t.jsxs)(J,{children:[Object(t.jsx)(u.a,{children:Object(t.jsx)("title",{children:e("metadata.HomePage.title")})}),o?Object(t.jsx)($,{lobby:o}):Object(t.jsx)(U,{})]})},H=Object(c.lazy)((function(){return r.e(3).then(r.bind(null,125))})),z=function(e){var n=e.children,r=Object(q.a)(e,["children"]);return Object(t.jsx)(M.b,Object(S.a)(Object(S.a)({},r),{},{children:Object(t.jsx)(c.Suspense,{fallback:Object(t.jsx)(B.a,{}),children:n})}))},G=function(){return Object(t.jsx)(F.a,{children:Object(t.jsxs)(M.d,{children:[Object(t.jsx)(M.b,{exact:!0,path:"/",children:Object(t.jsx)(Q,{})}),Object(t.jsx)(z,{path:"/lobby",children:Object(t.jsx)(H,{})}),Object(t.jsx)(M.b,{path:"*",children:Object(t.jsx)(M.a,{to:"/"})})]})})},W=w.b.div.withConfig({displayName:"styles__Root",componentId:"sc-4o4g7-0"})(["min-height:100vh;display:flex;flex-direction:column;background-color:",";"],(function(e){return e.theme.colors.background})),K=function(){var e=N(),n=e.loading,r=e.error;return n?Object(t.jsx)(W,{children:Object(t.jsx)(B.a,{})}):r?(console.error(r),Object(t.jsx)(W,{children:Object(t.jsx)("p",{children:"An error occurred while loading the app."})})):Object(t.jsx)(W,{children:Object(t.jsx)(G,{})})},V=function(){return Object(t.jsx)(u.b,{children:Object(t.jsx)(O,{children:Object(t.jsx)(_,{defaultTheme:"classic",children:Object(t.jsx)(T,{languages:["en","fr"],fallbackLanguage:"en",children:Object(t.jsx)(m,{children:Object(t.jsx)(K,{})})})})})})};i.a.render(Object(t.jsx)(a.a.StrictMode,{children:Object(t.jsx)(V,{})}),document.getElementById("root"))},36:function(e,n,r){"use strict";r.d(n,"a",(function(){return c}));var t=r(4),c=(r(2),function(){return Object(t.jsx)("p",{children:"Loading..."})})},47:function(e,n,r){"use strict";r.d(n,"a",(function(){return O})),r.d(n,"c",(function(){return p})),r.d(n,"d",(function(){return v})),r.d(n,"b",(function(){return x})),r.d(n,"e",(function(){return m})),r.d(n,"f",(function(){return L}));var t=r(32),c=r(10);function a(){var e=Object(t.a)(["\n  query LobbyPage {\n    viewer {\n      id\n      lobby {\n        ...LobbyFragment\n      }\n    }\n  }\n  ","\n"]);return a=function(){return e},e}function o(){var e=Object(t.a)(["\n  query LobbyJoinPage($lobbyId: String!) {\n    lobbyPreview(lobbyId: $lobbyId) {\n      id\n      nbMembers\n    }\n    viewer {\n      id\n      lobby {\n        ...LobbyFragment\n      }\n    }\n  }\n  ","\n"]);return o=function(){return e},e}function i(){var e=Object(t.a)(["\n  query HomePage {\n    viewer {\n      id\n      lobby {\n        ...LobbyFragment\n      }\n    }\n  }\n  ","\n"]);return i=function(){return e},e}function u(){var e=Object(t.a)(["\n  mutation LeaveLobby {\n    leaveLobby {\n      id\n      lobby {\n        ...LobbyFragment\n      }\n    }\n  }\n  ","\n"]);return u=function(){return e},e}function b(){var e=Object(t.a)(["\n  mutation JoinLobby($input: JoinLobbyInput!) {\n    joinLobby(input: $input) {\n      id\n      lobby {\n        ...LobbyFragment\n      }\n    }\n  }\n  ","\n"]);return b=function(){return e},e}function s(){var e=Object(t.a)(["\n  mutation CreateLobby($input: CreateLobbyInput!) {\n    createLobby(input: $input) {\n      id\n      lobby {\n        ...LobbyFragment\n      }\n    }\n  }\n  ","\n"]);return s=function(){return e},e}function l(){var e=Object(t.a)(["\n  fragment LobbyFragment on Lobby {\n    id\n    members {\n      id\n      name\n      role\n    }\n  }\n"]);return l=function(){return e},e}var d=Object(c.gql)(l()),j=Object(c.gql)(s(),d);function O(e){return c.useMutation(j,e)}var f=Object(c.gql)(b(),d);function p(e){return c.useMutation(f,e)}var h=Object(c.gql)(u(),d);function v(e){return c.useMutation(h,e)}var g=Object(c.gql)(i(),d);function x(e){return c.useQuery(g,e)}var y=Object(c.gql)(o(),d);function m(e){return c.useQuery(y,e)}var w=Object(c.gql)(a(),d);function L(e){return c.useQuery(w,e)}},69:function(e,n,r){"use strict";r.d(n,"a",(function(){return o}));var t=r(4),c=r(97),a=(r(2),r(94));var o=function(e){var n=e.error;if(n instanceof c.a){var r=function(e){var n;switch(null===(n=e.extensions)||void 0===n?void 0:n.code){case a.ErrorCode.USER_ALREADY_IN_LOBBY:return"User already in lobby";default:return}}(n);if(r)return Object(t.jsxs)("p",{children:["Error: ",r]})}return Object(t.jsx)("p",{children:"Error: The operation failed."})}},94:function(e,n,r){"use strict";var t=this&&this.__createBinding||(Object.create?function(e,n,r,t){void 0===t&&(t=r),Object.defineProperty(e,t,{enumerable:!0,get:function(){return n[r]}})}:function(e,n,r,t){void 0===t&&(t=r),e[t]=n[r]}),c=this&&this.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(n,"__esModule",{value:!0}),c(r(116),n)}},[[123,1,2]]]);
//# sourceMappingURL=main.1acc8b05.chunk.js.map